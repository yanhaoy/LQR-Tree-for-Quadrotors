function u = mylqr(x, xd)

K = [-1.61243012235147,1.61243012235033,0.499301723366613,-1.54009963434544,1.54009963434635,-0.739603999577528,-0.803543003384964,0.803543003384501,0.603075078969817,-0.0644195176065534,-0.0644195176065547,-0.381351086711616;1.61243012234999,1.61243012234872,0.499301723367020,-1.54009963434556,-1.54009963434507,0.739603999577081,0.803543003384527,0.803543003384090,0.603075078969782,-0.0644195176065537,0.0644195176065528,0.381351086711617;1.61243012234918,-1.61243012234944,0.499301723366658,1.54009963434583,-1.54009963434513,-0.739603999577398,0.803543003384333,-0.803543003384682,0.603075078969796,0.0644195176065539,0.0644195176065530,-0.381351086711618;-1.61243012235076,-1.61243012235117,0.499301723367039,1.54009963434579,1.54009963434644,0.739603999577205,-0.803543003384869,-0.803543003385148,0.603075078969812,0.0644195176065537,-0.0644195176065549,0.381351086711617];

u = repmat(27*1e-3*9.81/4, 4, 1) - K*(x-xd);

% Real
% a = 2.130295 * 1e-11;
% b = 1.032633 * 1e-6;
% c = 5.484560 * 1e-4 - u;

% Sim
a = 9.2416e-10;
b = 2.9342e-06;
c = 0.0023 - u;

u = (-b+sqrt(b^2-4*a*c))/(2*a);

end

function u = mylqr_pfl(x, xd)

K = [0,0,16.6831973004454,0,0,0,0,0,6.64637386721443,0,0,0;0,-7.16667204092404,0,48.0626149805232,0,0,0,-6.72194517378902,0,52.4478171616201,0,0;-7.16667204092404,0,0,0,48.0626149805232,0,-6.72194517378902,0,0,0,52.4478171616201,0;0,0,0,0,0,48.0626149805232,0,0,0,0,0,52.4478171616201];

J_wb_b = compJ(x(4:6));
xnew = x;
xnew(10:12) = J_wb_b\x(10:12);

u = -K*(xnew-xd);
u = compTau((xnew-xd),u);

% Real
a = 2.130295 * 1e-11;
b = 1.032633 * 1e-6;
c = 5.484560 * 1e-4 - u;

% Sim
% a = 9.2416e-10;
% b = 2.9342e-06;
% c = 0.0023 - u;

u = (-b+sqrt(b^2-4*a*c))/(2*a);

end
